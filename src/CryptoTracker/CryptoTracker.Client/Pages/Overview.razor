@page "/"
@using CryptoTracker.Shared
@rendermode InteractiveAuto
@inject HttpClient HttpClient

<PageTitle>Überblick</PageTitle>

<h1>Überblick</h1>

@if (IsLoading)
{
    <div class="d-flex justify-content-center my-5">
        <div class="spinner-border" role="status"></div>
    </div>
}
else
{
    <div class="mt-3" style="max-width:200px">
        <label for="walletCombo">Select Wallet:</label>
        <select id="walletCombo" class="form-select" @onchange="e => OnSelectedWalletChanged(e.Value?.ToString() ?? string.Empty)">
            <option value="">Select Wallet</option>
            @if (Wallets != null)
            {
                foreach (var w in Wallets)
                {
                    <option value="@w.Name">@w.Name</option>
                }
            }
        </select>
    </div>

    <div class="mt-3" style="max-width:200px">
        <label for="symbolCombo">Select Symbol:</label>
        <select id="symbolCombo" class="form-select" @onchange="OnSelectedSymbolChanged">
            <option value="">Select Symbol</option>
            @if (Symbols != null)
            {
                foreach (var s in Symbols)
                {
                    <option value="@s">@s</option>
                }
            }
        </select>
    </div>

    <div class="mt-3">
        <DataGrid TItem="FlowDTO" Data="Flows" Sortable="true" Filterable="true" Resizable="true" ShowPager="false">
            <DataGridColumns>
                <DataGridColumn TItem="FlowDTO" Field="@nameof(FlowDTO.DateTime)" Caption="DateTime" />
                <DataGridColumn TItem="FlowDTO" Field="@nameof(FlowDTO.FlowType)" Caption="FlowType" />
                <DataGridColumn TItem="FlowDTO" Field="@nameof(FlowDTO.FlowDirection)" Caption="FlowDirection" />
                <DataGridColumn TItem="FlowDTO" Field="@nameof(FlowDTO.SourceWallet)" Caption="SourceWallet" />
                <DataGridColumn TItem="FlowDTO" Field="@nameof(FlowDTO.TargetWallet)" Caption="TargetWallet" />
                <DataGridColumn TItem="FlowDTO" Field="@nameof(FlowDTO.FlowAmount)" Caption="FlowAmount" />
            </DataGridColumns>
        </DataGrid>
    </div>

    <div class="mt-3">
        <p>Balance: @Balance</p>
    </div>
}

@if (ErrorMessage != null)
{
    <div class="alert alert-danger" role="alert" style="margin-top:20px">
        @ErrorMessage
    </div>
}